<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Reproduction of an I Quant NY page</title>
		<script type="text/javascript" src="../d3.js"></script>
		<style type="text/css">

		body {
			font-family: 'Lucida Grande', 'Helvetica Neue', Helvetica, Arial, sans-serif;
			font-size: 10px;
			color: #202020;
			background: #FFFFFF;
			margin: 40px 0 20px 0;
			padding: 0;
		}

		a:active, a:focus { outline: 0; }

		#content {
			width: 770px;
			margin: 0 auto;
		}

			#content #header {
				border-bottom: 3px solid #202020;
			}

				#content #header #top {
					border-bottom: 1px solid #202020;
					padding: 0 0 10px 0;
					position: relative;
				}
					#content #header #note p {
						font-weight: bold;
						text-transform: uppercase;
					}
					#content #header #top p.title {
						width: 688px;
						color: #202020;
						font-family: Georgia;
						font-size: 72px;
						font-style: italic;
						font-weight: normal;
						letter-spacing: -3px;
						text-decoration: none;
						margin: 0;
					}

				#content #header #bottom {
					font-size: 10px;
					padding: 8px 0;
				}

					#content #header #bottom a {
						color: #447777;
						font-weight: bold;
						text-decoration: none;
					}
			#content #newDay {
				border-top: 1px solid #202020;
				padding: 8px 0 0 0;
			}

			#content #newDay .post { margin: 20px 0 70px 0; }

			#content #newDay .date {
				font-weight: bold;
				text-transform: uppercase;
			}

			#content #newDay h2 {
				font-family: Georgia;
				font-size: 36px;
				letter-spacing: -1px;
				line-height:1.3;
				margin: 0;
			}

				#content #newDay a.h2 {
					color: #0F6F9F;
					font-family: Georgia;
					font-size: 36px;
					font-weight: bold;
					text-decoration: underline;
					letter-spacing: -1px;
					line-height: 34px;
					margin: 0;
				}

				  #content #newDay a.h2.title {
					color: #202020;
				  }

				#content #newDay .quote {
					font-family: Georgia;
					font-size: 24px;
					line-height: 1.3em;
				}

			#content #newDay .post {
				font-family: Georgia;
				font-size: 14px;
				line-height: 1.6em;
			}

				#content #newDay .post a {
					color: #0F6F9F;
					text-decoration: none;
				}
		</style>
	</head>
	<body>
	<div id="content">
		<div id="header">
			<div id="note">
			<p class="note">
				Note: This is a reproduction of <a href="http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the">this</a> page by Ben Wellington.
			</p>
			</div>
			<div id="top">
			<p class="title">I Quant NY</p>
			</div>
			<div id="bottom">
			<p>
				Quantitative Analysis of NYC Open Data: Every data set that the city releases tells a story. This blog is all about telling those stories, one data set at a time.
			</p>
			</div>
		</div>


		<div id="newDay">
		<div class="date">
			September 18, 2015
		</div>
		<div class="post">
			<a href="http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the" class="h2 title">This is Quantifiably the Best Month to go to the Farmers Market</a>
			<p>
				As part of a homework assignment, I ask my students at Pratt to go out and chart something of interest to them, and Katherine Savarese came back with a simple chart about farmers markets that I loved- it inspired this post.
			</p>
			<p>
				You probably know that farmers markets are a staple across all five boroughs of New York City, but September happens to be a very special month. Why is that?  Well, it turns out September is the month with the most unique types of fresh produce- forty three to be exact.
			</p>
			<p>
				To show the current offerings, we charted how many types of fruits and vegetables are available by month, and showed if they were fresh or from storage.
			</p>
			<div id="figure">
<script type="text/javascript">

	//Loading dataset
	var dataset;
	var fruit_harvest = [];
	var fruit_storage = [];
	var veg_harvest = [];
	var veg_storage = [];
	var months = [];
	var xScale;
	var yScale;

	d3.csv("data.csv", function(data){
		dataset = data;
	/*	fruit_harvest = data.slice(0,12);
		fruit_storage = data.slice(12,24);
		veg_harvest = data.slice(24,36);
		veg_storage = data.slice(36,48);*/

		for (var i=0; i<12; i++){
			months.push(dataset[i].Month);
			fruit_harvest.push(dataset[i].Count);
			fruit_storage.push(dataset[i+12].Count);
			veg_harvest.push(dataset[i+24].Count);
			veg_storage.push(dataset[i+36].Count);
		}

		var margin = {top: 20, right: 20, bottom: 20, left: 30};
		var w = 700 - margin.left - margin.right;
		var h = 250 - margin.top - margin.bottom;

		var svg = d3.selectAll("#figure")
					.append("svg")
					.attr("width", w + margin.left + margin.right)
					.attr("height", h + margin.top + margin.bottom)
					.append("g")
					.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

		xScale = d3.scaleBand()
					.domain(months)
					.rangeRound([0, w])
					.paddingInner(0.05);

		yScale = d3.scaleLinear()
						.domain([0, d3.max(fruit_harvest)])
						.range([h, 0]);

		//Define X axis
		var xAxis = d3.axisBottom()
						  .scale(xScale)
						  .ticks(5);

		//Define Y axis
		var yAxis = d3.axisLeft()
						  .scale(yScale)
						  .ticks(5);

		svg.append("g")
			.attr("transform", "translate(0," + h + ")")
			.call(xAxis);

		svg.append("g")
			.attr("class","yaxis")
			.call(yAxis);

		var trans_duration=500;
		var easing = d3.easeCubicInOut;
		//Create bars
		svg.selectAll("rect")
		   .data(fruit_harvest)
		   .enter()
		   .append("rect")
		   .transition()
		   .duration(trans_duration)
		   .ease(easing)
		   .attr("x", function(d, i) {
				return xScale(months[i]);
		   })
		   .attr("y", function(d) {
				return yScale(d);
		   })
		   .attr("width", xScale.bandwidth())
		   .attr("height", function(d) {
				return yScale(0) - yScale(d);
		   })
		   .attr("fill", "rgb(254,42,30)");



	   // Adding text at the bottom for selecting what data to shows
	   var bottom_bar = d3.selectAll("#figure")
   					.append("svg")
   					.attr("width", w + margin.left + margin.right)
   					.attr("height", 50 + margin.top + margin.bottom)
   					.append("g")
   					.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		bottom_bar.append("text")
			.text("Click on the categories below to show the respective data!");
		// Adding separate text elements for all categories
		bottom_bar.append("g")
		.attr("id", "fresh_fruit")
		.attr("transform", "translate(" + 75 + "," + 50 + ")")
		.append("text")
		.text("Fresh Fruit")
		.attr("font-weight","bold");

		bottom_bar.append("g")
		.attr("id", "fresh_veg")
		.attr("transform", "translate(" + 225 + "," + 50 + ")")
		.append("text")
		.text("Fresh Vegetable")
		.attr("font-weight","bold");

		bottom_bar.append("g")
		.attr("id", "storage_fruit")
		.attr("transform", "translate(" + 375 + "," + 50 + ")")
		.append("text")
		.text("Storage Fruit")
		.attr("font-weight","bold");

		bottom_bar.append("g")
		.attr("id", "storage_veg")
		.attr("transform", "translate(" + 525 + "," + 50 + ")")
		.append("text")
		.text("Storage Vegetable")
		.attr("font-weight","bold");



		// Transitions for using different data categories
		d3.select("#fresh_fruit")
			.on("click", function(){

			yScale.domain([0, d3.max(fruit_harvest)]);
			d3.select(".yaxis")
				.transition()
				.call(yAxis);

			var trans_duration=500;
			var easing = d3.easeCubicInOut;
			//Create bars
			svg.selectAll("rect")
			   .data(fruit_harvest)
			   .transition()
			   .duration(trans_duration)
			   .ease(easing)
			   .attr("y", function(d) {
					return yScale(d);
			   })
			   .attr("height", function(d) {
					return yScale(0) - yScale(d);
			   })
			   .attr("fill", "rgb(254,42,30)");
			});

		d3.select("#fresh_veg")
			.on("click", function(){

			yScale.domain([0, d3.max(veg_harvest)]);
			d3.select(".yaxis")
				.transition()
				.call(yAxis);

			var trans_duration=500;
			var easing = d3.easeCubicInOut;
			//Create bars
			svg.selectAll("rect")
			   .data(veg_harvest)
			   .transition()
			   .duration(trans_duration)
			   .ease(easing)
			   .attr("y", function(d) {
					return yScale(d);
			   })
			   .attr("height", function(d) {
					return yScale(0) - yScale(d);
			   })
			   .attr("fill", "rgb(0,142,15)");
			});

		d3.select("#storage_fruit")
			.on("click", function(){

			yScale.domain([0, d3.max(fruit_storage)]);
			d3.select(".yaxis")
				.transition()
				.call(yAxis);

			var trans_duration=500;
			var easing = d3.easeCubicInOut;
			//Create bars
			svg.selectAll("rect")
			   .data(fruit_storage)
			   .transition()
			   .duration(trans_duration)
			   .ease(easing)
			   .attr("y", function(d) {
					return yScale(d);
			   })
			   .attr("height", function(d) {
					return yScale(0) - yScale(d);
			   })
			   .attr("fill", "rgb(249,162,165)");
			});

		d3.select("#storage_veg")
			.on("click", function(){

			yScale.domain([0, d3.max(veg_storage)]);
			d3.select(".yaxis")
				.transition()
				.call(yAxis);

			var trans_duration=500;
			var easing = d3.easeCubicInOut;
			//Create bars
			svg.selectAll("rect")
			   .data(veg_storage)
			   .transition()
			   .duration(trans_duration)
			   .ease(easing)
			   .attr("y", function(d) {
					return yScale(d);
			   })
			   .attr("height", function(d) {
					return yScale(0) - yScale(d);
			   })
			   .attr("fill", "rgb(223,232,201)");
			});
	})



</script>
			</div>
			<p>
				If you miss the month of September, you might be behind the fruit curve, but there are plenty more months of vegetables left.  The chart shows that fresh vegetables are available 9 out of 12 months, but fruit is only available 5 out of 12. Now if only we could quantify how delicious the produce is…
			</p>
			<p>—–</p>
			<p>
				Data from: <a href="https://t.umblr.com/redirect?z=http%3A%2F%2Fwww.grownyc.org%2Fgreenmarket%2Fwhatsavailable&t=MWU3YTNhNmYwMDJkNWUwNWQzOTUwMTZjMzJlMGNhM2E3YzdlNTIxMCwxeHM2a1phNg%3D%3D&b=t%3A5jlxwUw4OZ-2SbgNDPgKMQ&p=http%3A%2F%2Fiquantny.tumblr.com%2Fpost%2F129373499164%2Fthis-is-quantifiably-the-best-month-to-go-to-the&m=1">http://www.grownyc.org/greenmarket/whatsavailable</a>
			</p>
		</div>
		</div>
	</div>
	</body>
</html>
